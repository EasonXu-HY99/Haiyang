<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xu Haiyang">
<meta name="dcterms.date" content="2025-03-12">

<title>Cobalt Strike: Advanced Adversary Simulation Platform – Haiyang’s Tech Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Haiyang’s Tech Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Project Intern</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html"> 
<span class="menu-text">Haiyang Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cybersecurity.html"> 
<span class="menu-text">Cybersecurity</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tools.html"> 
<span class="menu-text">Cyber Tools</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../coding.html"> 
<span class="menu-text">Coding</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cloud.html"> 
<span class="menu-text">Cloud</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../github.html"> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../ai.html"> 
<span class="menu-text">AI</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EasonXu-HY99"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/haiyang-xu-8a2151212/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-cobalt-strike" id="toc-introduction-to-cobalt-strike" class="nav-link active" data-scroll-target="#introduction-to-cobalt-strike">Introduction to Cobalt Strike</a></li>
  <li><a href="#key-components-and-architecture" id="toc-key-components-and-architecture" class="nav-link" data-scroll-target="#key-components-and-architecture">Key Components and Architecture</a>
  <ul class="collapse">
  <li><a href="#team-server" id="toc-team-server" class="nav-link" data-scroll-target="#team-server">Team Server</a></li>
  <li><a href="#client-interface" id="toc-client-interface" class="nav-link" data-scroll-target="#client-interface">Client Interface</a></li>
  <li><a href="#beacon" id="toc-beacon" class="nav-link" data-scroll-target="#beacon">Beacon</a></li>
  </ul></li>
  <li><a href="#core-capabilities" id="toc-core-capabilities" class="nav-link" data-scroll-target="#core-capabilities">Core Capabilities</a>
  <ul class="collapse">
  <li><a href="#command-and-control-infrastructure" id="toc-command-and-control-infrastructure" class="nav-link" data-scroll-target="#command-and-control-infrastructure">Command and Control Infrastructure</a></li>
  <li><a href="#initial-compromise-techniques" id="toc-initial-compromise-techniques" class="nav-link" data-scroll-target="#initial-compromise-techniques">Initial Compromise Techniques</a></li>
  <li><a href="#post-exploitation-capabilities" id="toc-post-exploitation-capabilities" class="nav-link" data-scroll-target="#post-exploitation-capabilities">Post-Exploitation Capabilities</a></li>
  <li><a href="#privilege-escalation" id="toc-privilege-escalation" class="nav-link" data-scroll-target="#privilege-escalation">Privilege Escalation</a></li>
  <li><a href="#persistence-mechanisms" id="toc-persistence-mechanisms" class="nav-link" data-scroll-target="#persistence-mechanisms">Persistence Mechanisms</a></li>
  </ul></li>
  <li><a href="#cobalt-strike-workflow" id="toc-cobalt-strike-workflow" class="nav-link" data-scroll-target="#cobalt-strike-workflow">Cobalt Strike Workflow</a></li>
  <li><a href="#extensibility-aggressor-script" id="toc-extensibility-aggressor-script" class="nav-link" data-scroll-target="#extensibility-aggressor-script">Extensibility: Aggressor Script</a></li>
  <li><a href="#demonstration" id="toc-demonstration" class="nav-link" data-scroll-target="#demonstration">Demonstration</a></li>
  <li><a href="#opsec-considerations" id="toc-opsec-considerations" class="nav-link" data-scroll-target="#opsec-considerations">OPSEC Considerations</a>
  <ul class="collapse">
  <li><a href="#traffic-obfuscation" id="toc-traffic-obfuscation" class="nav-link" data-scroll-target="#traffic-obfuscation">Traffic Obfuscation</a></li>
  <li><a href="#host-based-artifacts" id="toc-host-based-artifacts" class="nav-link" data-scroll-target="#host-based-artifacts">Host-Based Artifacts</a></li>
  <li><a href="#detection-evasion" id="toc-detection-evasion" class="nav-link" data-scroll-target="#detection-evasion">Detection Evasion</a></li>
  </ul></li>
  <li><a href="#beacon-object-files-bofs" id="toc-beacon-object-files-bofs" class="nav-link" data-scroll-target="#beacon-object-files-bofs">Beacon Object Files (BOFs)</a></li>
  <li><a href="#legitimate-use-cases" id="toc-legitimate-use-cases" class="nav-link" data-scroll-target="#legitimate-use-cases">Legitimate Use Cases</a>
  <ul class="collapse">
  <li><a href="#red-team-operations" id="toc-red-team-operations" class="nav-link" data-scroll-target="#red-team-operations">Red Team Operations</a></li>
  <li><a href="#adversary-emulation" id="toc-adversary-emulation" class="nav-link" data-scroll-target="#adversary-emulation">Adversary Emulation</a></li>
  <li><a href="#security-control-validation" id="toc-security-control-validation" class="nav-link" data-scroll-target="#security-control-validation">Security Control Validation</a></li>
  </ul></li>
  <li><a href="#cobalt-strike-vs.-other-frameworks" id="toc-cobalt-strike-vs.-other-frameworks" class="nav-link" data-scroll-target="#cobalt-strike-vs.-other-frameworks">Cobalt Strike vs.&nbsp;Other Frameworks</a></li>
  <li><a href="#ethical-and-legal-considerations" id="toc-ethical-and-legal-considerations" class="nav-link" data-scroll-target="#ethical-and-legal-considerations">Ethical and Legal Considerations</a></li>
  <li><a href="#detection-and-defense" id="toc-detection-and-defense" class="nav-link" data-scroll-target="#detection-and-defense">Detection and Defense</a>
  <ul class="collapse">
  <li><a href="#network-detection" id="toc-network-detection" class="nav-link" data-scroll-target="#network-detection">Network Detection</a></li>
  <li><a href="#host-based-detection" id="toc-host-based-detection" class="nav-link" data-scroll-target="#host-based-detection">Host-Based Detection</a></li>
  <li><a href="#recommended-controls" id="toc-recommended-controls" class="nav-link" data-scroll-target="#recommended-controls">Recommended Controls</a></li>
  </ul></li>
  <li><a href="#recent-developments" id="toc-recent-developments" class="nav-link" data-scroll-target="#recent-developments">Recent Developments</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cobalt Strike: Advanced Adversary Simulation Platform</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Exploitation</div>
    <div class="quarto-category">Red Team Operations</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xu Haiyang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 12, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction-to-cobalt-strike" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-cobalt-strike">Introduction to Cobalt Strike</h2>
<p>Cobalt Strike is a powerful commercial penetration testing tool that has become the de facto standard for advanced adversary simulation and red team operations. Developed by Raphael Mudge in 2012 and now maintained by HelpSystems (following its acquisition of Strategic Cyber LLC), Cobalt Strike provides a comprehensive post-exploitation framework that emulates sophisticated threat actors.</p>
<p>Unlike traditional vulnerability scanners or exploitation frameworks, Cobalt Strike focuses on the post-exploitation phase—what happens after initial access is gained. Its design philosophy centers around stealth, persistence, and team-oriented operations, making it uniquely suited for simulating advanced persistent threats (APTs) and conducting extended red team engagements.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-defining-cobalt-strike_hjdr.max-1900x1900.png" class="img-fluid figure-img"></p>
<figcaption>Cobalt Strike Console Interface</figcaption>
</figure>
</div>
</section>
<section id="key-components-and-architecture" class="level2">
<h2 class="anchored" data-anchor-id="key-components-and-architecture">Key Components and Architecture</h2>
<p>Cobalt Strike operates on a client-server architecture consisting of three primary components:</p>
<section id="team-server" class="level3">
<h3 class="anchored" data-anchor-id="team-server">Team Server</h3>
<p>The Team Server is the command and control (C2) hub that:</p>
<ul>
<li>Manages all operations and Beacons</li>
<li>Provides collaboration features for team members</li>
<li>Handles listener configurations and payload generation</li>
<li>Maintains the operation’s database</li>
<li>Serves as the central communication point</li>
</ul>
</section>
<section id="client-interface" class="level3">
<h3 class="anchored" data-anchor-id="client-interface">Client Interface</h3>
<p>The Java-based client interface connects to the Team Server and provides:</p>
<ul>
<li>Intuitive graphical user interface</li>
<li>Real-time collaboration capabilities</li>
<li>Visualization of target networks</li>
<li>Access to post-exploitation modules</li>
<li>Reporting and logging features</li>
</ul>
</section>
<section id="beacon" class="level3">
<h3 class="anchored" data-anchor-id="beacon">Beacon</h3>
<p>Beacon is Cobalt Strike’s primary payload and post-exploitation agent:</p>
<ul>
<li>Communicates with the Team Server using customizable protocols</li>
<li>Provides extensive post-exploitation capabilities</li>
<li>Supports asynchronous (“sleep”) or interactive operation modes</li>
<li>Available in both DNS and HTTP/S variants</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-defining-cobalt-strike_0_ugoy.max-1400x1400.png" class="img-fluid figure-img"></p>
<figcaption>Cobalt Strike Architecture</figcaption>
</figure>
</div>
</section>
</section>
<section id="core-capabilities" class="level2">
<h2 class="anchored" data-anchor-id="core-capabilities">Core Capabilities</h2>
<section id="command-and-control-infrastructure" class="level3">
<h3 class="anchored" data-anchor-id="command-and-control-infrastructure">Command and Control Infrastructure</h3>
<p>Cobalt Strike offers sophisticated C2 capabilities:</p>
<ul>
<li>Malleable C2 profiles for customizing network signatures</li>
<li>Domain fronting support</li>
<li>DNS tunneling</li>
<li>HTTPS communication with custom certificate options</li>
<li>SMB beacon for internal pivot operations</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a># Example Malleable C2 Profile</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a># This configures how the Beacon payload appears on the network</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> sleeptime <span class="st">"5000"</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> jitter    <span class="st">"20"</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> useragent <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36"</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>http<span class="op">-</span><span class="kw">get</span> {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> uri <span class="st">"/news/"</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    client {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        header <span class="st">"Accept"</span> <span class="st">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span><span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        header <span class="st">"Accept-Language"</span> <span class="st">"en-US,en;q=0.5"</span><span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        header <span class="st">"Accept-Encoding"</span> <span class="st">"gzip, deflate"</span><span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        metadata {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            base64url<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            prepend <span class="st">"session="</span><span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            header <span class="st">"Cookie"</span><span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    server {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        header <span class="st">"Server"</span> <span class="st">"Apache"</span><span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        header <span class="st">"X-Powered-By"</span> <span class="st">"PHP/7.4.1"</span><span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        header <span class="st">"Content-Type"</span> <span class="st">"text/html; charset=utf-8"</span><span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        output {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            mask<span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            base64url<span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            prepend <span class="st">"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;News&lt;/title&gt;&lt;/head&gt;&lt;body&gt;"</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            append <span class="st">"&lt;/body&gt;&lt;/html&gt;"</span><span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a># Additional profile configurations<span class="op">...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="initial-compromise-techniques" class="level3">
<h3 class="anchored" data-anchor-id="initial-compromise-techniques">Initial Compromise Techniques</h3>
<p>Cobalt Strike provides various vectors for initial access:</p>
<ul>
<li>Spear phishing with the built-in Spear Phishing tool</li>
<li>Web Drive-by attacks via the Scripted Web Delivery</li>
<li>Strategic Web Compromises</li>
<li>USB deployment options</li>
<li>Office macro payloads</li>
</ul>
</section>
<section id="post-exploitation-capabilities" class="level3">
<h3 class="anchored" data-anchor-id="post-exploitation-capabilities">Post-Exploitation Capabilities</h3>
<p>Once a target is compromised, Cobalt Strike offers extensive post-exploitation features:</p>
<ul>
<li>Process injection and migration</li>
<li>Credential harvesting (Mimikatz integration)</li>
<li>Keylogging and screenshot capture</li>
<li>File system operations</li>
<li>Port scanning and network enumeration</li>
<li>Token manipulation</li>
<li>Lateral movement techniques</li>
</ul>
</section>
<section id="privilege-escalation" class="level3">
<h3 class="anchored" data-anchor-id="privilege-escalation">Privilege Escalation</h3>
<p>Cobalt Strike includes multiple privilege escalation options:</p>
<ul>
<li>UAC bypass techniques</li>
<li>Exploit integration</li>
<li>Process elevation through token manipulation</li>
<li>Custom escalation scripts via Aggressor Script</li>
</ul>
</section>
<section id="persistence-mechanisms" class="level3">
<h3 class="anchored" data-anchor-id="persistence-mechanisms">Persistence Mechanisms</h3>
<p>For maintaining access, Cobalt Strike provides:</p>
<ul>
<li>Service creation and modification</li>
<li>Registry modifications</li>
<li>Scheduled tasks</li>
<li>WMI event subscriptions</li>
<li>COM hijacking options</li>
</ul>
</section>
</section>
<section id="cobalt-strike-workflow" class="level2">
<h2 class="anchored" data-anchor-id="cobalt-strike-workflow">Cobalt Strike Workflow</h2>
<p>A typical Cobalt Strike operation follows this workflow:</p>
<pre class="mermaid"><code>graph TD
    A[Initial Access] --&gt; B[Beacon Deployment]
    B --&gt; C[Host Reconnaissance]
    C --&gt; D[Privilege Escalation]
    D --&gt; E[Credential Harvesting]
    E --&gt; F[Lateral Movement]
    F --&gt; G[Persistence]
    G --&gt; H[Mission Objectives]
    
    style A fill:#f9f9f9,stroke:#333,stroke-width:2px
    style B fill:#f9f9f9,stroke:#333,stroke-width:2px
    style C fill:#f9f9f9,stroke:#333,stroke-width:2px
    style D fill:#f9f9f9,stroke:#333,stroke-width:2px
    style E fill:#f9f9f9,stroke:#333,stroke-width:2px
    style F fill:#f9f9f9,stroke:#333,stroke-width:2px
    style G fill:#f9f9f9,stroke:#333,stroke-width:2px
    style H fill:#f9f9f9,stroke:#333,stroke-width:2px</code></pre>
</section>
<section id="extensibility-aggressor-script" class="level2">
<h2 class="anchored" data-anchor-id="extensibility-aggressor-script">Extensibility: Aggressor Script</h2>
<p>Cobalt Strike’s scripting language, Aggressor Script, allows for powerful customization:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode java code-with-copy"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a># Example Aggressor Script <span class="op">-</span> Custom beacon command</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a># Register a <span class="kw">new</span> beacon command</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">beacon_command_register</span><span class="op">(</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"systeminfo"</span><span class="op">,</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Retrieves detailed system information"</span><span class="op">,</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Synopsis: systeminfo</span><span class="sc">\n\n</span><span class="st">Retrieves detailed system information from the target system."</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="op">);</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a># Define what happens when the command is used</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>alias systeminfo <span class="op">{</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">local</span><span class="op">(</span><span class="er">'</span>$bid<span class="er">'</span><span class="op">);</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    $bid <span class="op">=</span> $<span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    # Run the systeminfo command</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">beacon_execute_job</span><span class="op">(</span>$bid<span class="op">,</span> <span class="st">"systeminfo"</span><span class="op">,</span> <span class="st">"systeminfo"</span><span class="op">);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    # Log the action</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">blog</span><span class="op">(</span>$bid<span class="op">,</span> <span class="st">"Tasked beacon to retrieve system info"</span><span class="op">);</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="demonstration" class="level2">
<h2 class="anchored" data-anchor-id="demonstration">Demonstration</h2>
<p>The video below demonstrates a simulated red team operation using Cobalt Strike:</p>
<div class="ratio ratio-16x9">
<iframe width="560" height="315" src="https://www.youtube.com/embed/T8vYD3QJSXI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
</div>
</section>
<section id="opsec-considerations" class="level2">
<h2 class="anchored" data-anchor-id="opsec-considerations">OPSEC Considerations</h2>
<p>Cobalt Strike provides several features to maintain operational security:</p>
<section id="traffic-obfuscation" class="level3">
<h3 class="anchored" data-anchor-id="traffic-obfuscation">Traffic Obfuscation</h3>
<ul>
<li>Customizable C2 profiles</li>
<li>Traffic padding</li>
<li>Connection rotation</li>
<li>Jitter and sleep timers</li>
</ul>
</section>
<section id="host-based-artifacts" class="level3">
<h3 class="anchored" data-anchor-id="host-based-artifacts">Host-Based Artifacts</h3>
<ul>
<li>Memory-only payloads (BOFs)</li>
<li>Process injection options</li>
<li>In-memory evasion techniques</li>
<li>AMSI bypass capabilities</li>
</ul>
</section>
<section id="detection-evasion" class="level3">
<h3 class="anchored" data-anchor-id="detection-evasion">Detection Evasion</h3>
<ul>
<li>Indirect syscalls</li>
<li>Reflective loading</li>
<li>Anti-forensic techniques</li>
<li>Custom tool implementation via BOFs</li>
</ul>
</section>
</section>
<section id="beacon-object-files-bofs" class="level2">
<h2 class="anchored" data-anchor-id="beacon-object-files-bofs">Beacon Object Files (BOFs)</h2>
<p>One of Cobalt Strike’s most powerful recent additions is the Beacon Object Files (BOFs) capability:</p>
<ul>
<li>Small C programs compiled to position-independent code</li>
<li>Executed directly in the Beacon process</li>
<li>Minimal footprint with no new processes</li>
<li>Growing ecosystem of custom BOFs for specialized tasks</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Example BOF - Simple hostname retriever</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;windows.h&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">"beacon.h"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> go<span class="op">(</span><span class="dt">char</span> <span class="op">*</span> args<span class="op">,</span> <span class="dt">int</span> alen<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    CHAR hostname<span class="op">[</span><span class="dv">256</span><span class="op">];</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    DWORD hostnameLen <span class="op">=</span> <span class="dv">256</span><span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>GetComputerNameA<span class="op">(</span>hostname<span class="op">,</span> <span class="op">&amp;</span>hostnameLen<span class="op">))</span> <span class="op">{</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        BeaconPrintf<span class="op">(</span>CALLBACK_OUTPUT<span class="op">,</span> <span class="st">"Hostname: </span><span class="sc">%s</span><span class="st">"</span><span class="op">,</span> hostname<span class="op">);</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        BeaconPrintf<span class="op">(</span>CALLBACK_ERROR<span class="op">,</span> <span class="st">"Failed to retrieve hostname"</span><span class="op">);</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="legitimate-use-cases" class="level2">
<h2 class="anchored" data-anchor-id="legitimate-use-cases">Legitimate Use Cases</h2>
<p>As a commercial tool, Cobalt Strike is designed for legitimate security testing:</p>
<section id="red-team-operations" class="level3">
<h3 class="anchored" data-anchor-id="red-team-operations">Red Team Operations</h3>
<ul>
<li>Simulating sophisticated adversaries</li>
<li>Testing blue team detection capabilities</li>
<li>Validating security controls</li>
<li>Training security teams</li>
</ul>
</section>
<section id="adversary-emulation" class="level3">
<h3 class="anchored" data-anchor-id="adversary-emulation">Adversary Emulation</h3>
<ul>
<li>Emulating known threat actor TTPs</li>
<li>MITRE ATT&amp;CK alignment</li>
<li>Scenario-based security testing</li>
</ul>
</section>
<section id="security-control-validation" class="level3">
<h3 class="anchored" data-anchor-id="security-control-validation">Security Control Validation</h3>
<ul>
<li>Testing endpoint protection solutions</li>
<li>Validating network detection systems</li>
<li>Assessing security monitoring capabilities</li>
</ul>
</section>
</section>
<section id="cobalt-strike-vs.-other-frameworks" class="level2">
<h2 class="anchored" data-anchor-id="cobalt-strike-vs.-other-frameworks">Cobalt Strike vs.&nbsp;Other Frameworks</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Cobalt Strike</th>
<th>Metasploit</th>
<th>Empire</th>
<th>Core Impact</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Focus</td>
<td>Post-exploitation</td>
<td>Exploitation</td>
<td>Post-exploitation</td>
<td>Full-spectrum</td>
</tr>
<tr class="even">
<td>C2 Capabilities</td>
<td>Advanced</td>
<td>Basic</td>
<td>Moderate</td>
<td>Advanced</td>
</tr>
<tr class="odd">
<td>Evasion Features</td>
<td>Extensive</td>
<td>Limited</td>
<td>Moderate</td>
<td>Moderate</td>
</tr>
<tr class="even">
<td>Team Collaboration</td>
<td>Built-in</td>
<td>Limited</td>
<td>Limited</td>
<td>Built-in</td>
</tr>
<tr class="odd">
<td>Customization</td>
<td>Aggressor Script</td>
<td>Ruby</td>
<td>PowerShell</td>
<td>Python API</td>
</tr>
<tr class="even">
<td>GUI Interface</td>
<td>Comprehensive</td>
<td>Limited</td>
<td>Web-based</td>
<td>Comprehensive</td>
</tr>
<tr class="odd">
<td>Price Point</td>
<td>Commercial</td>
<td>Free/Commercial</td>
<td>Free</td>
<td>Enterprise</td>
</tr>
<tr class="even">
<td>Learning Curve</td>
<td>Moderate</td>
<td>Steep</td>
<td>Moderate</td>
<td>Moderate</td>
</tr>
</tbody>
</table>
</section>
<section id="ethical-and-legal-considerations" class="level2">
<h2 class="anchored" data-anchor-id="ethical-and-legal-considerations">Ethical and Legal Considerations</h2>
<p>Cobalt Strike is a dual-use tool with significant capabilities:</p>
<ul>
<li>Requires proper authorization before use</li>
<li>Limited to legitimate security testing</li>
<li>License agreement restricts malicious use</li>
<li>Export controlled in some jurisdictions</li>
</ul>
<p>Unfortunately, cracked versions have been widely used by threat actors, necessitating responsible use by security professionals.</p>
</section>
<section id="detection-and-defense" class="level2">
<h2 class="anchored" data-anchor-id="detection-and-defense">Detection and Defense</h2>
<p>Organizations can defend against Cobalt Strike by:</p>
<section id="network-detection" class="level3">
<h3 class="anchored" data-anchor-id="network-detection">Network Detection</h3>
<ul>
<li>Monitoring for known C2 patterns</li>
<li>TLS inspection where possible</li>
<li>DNS anomaly detection</li>
<li>Behavioral analysis of network traffic</li>
</ul>
</section>
<section id="host-based-detection" class="level3">
<h3 class="anchored" data-anchor-id="host-based-detection">Host-Based Detection</h3>
<ul>
<li>Memory scanning for known Beacon signatures</li>
<li>API call monitoring</li>
<li>Process relationship analysis</li>
<li>PowerShell logging and script block logging</li>
</ul>
</section>
<section id="recommended-controls" class="level3">
<h3 class="anchored" data-anchor-id="recommended-controls">Recommended Controls</h3>
<ul>
<li>Application whitelisting</li>
<li>Network segmentation</li>
<li>Endpoint Detection and Response (EDR) solutions</li>
<li>Advanced logging and monitoring</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.cobalt.io/hs-fs/hubfs/Offensive-versus-defensive-venn-diagrams.png?width=739&amp;height=453&amp;name=Offensive-versus-defensive-venn-diagrams.png" class="img-fluid figure-img"></p>
<figcaption>Defense-in-Depth Strategy</figcaption>
</figure>
</div>
</section>
</section>
<section id="recent-developments" class="level2">
<h2 class="anchored" data-anchor-id="recent-developments">Recent Developments</h2>
<p>As of 2025, Cobalt Strike continues to evolve:</p>
<ul>
<li>Enhanced evasion capabilities</li>
<li>Expanded BOF ecosystem</li>
<li>Improved cloud environment testing features</li>
<li>Advanced lateral movement techniques</li>
<li>Deeper integration with threat intelligence</li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Cobalt Strike remains the gold standard for adversary simulation and red team operations. Its powerful capabilities allow security teams to test their defenses against realistic attack scenarios and sophisticated adversaries. While its power requires responsible use, Cobalt Strike continues to be an essential tool for organizations seeking to validate their security posture through realistic adversary simulation.</p>
<p>The balance between offensive tools like Cobalt Strike and defensive technologies represents the ongoing evolution of the cybersecurity landscape. As attack tools become more sophisticated, defenders must continually adapt and improve their detection and response capabilities.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>HelpSystems. (2024). “Cobalt Strike: Adversary Simulation and Red Team Operations.” Product Documentation.</li>
<li>Mudge, R. (2023). “Red Team Operations with Cobalt Strike.” Advanced Persistent Security.</li>
<li>MITRE ATT&amp;CK. (2024). “Software: Cobalt Strike.” MITRE Corporation.</li>
<li>National Security Agency. (2024). “Detecting Abuse of Authentication Mechanisms.” Cybersecurity Advisory.</li>
<li>Williams, J., &amp; Thompson, L. (2024). “Modern Adversary Simulation Techniques.” <em>Journal of Cybersecurity Operations</em>, 9(2), 54-68.</li>
<li>Cyber Threat Intelligence Team. (2024). “Evolution of Adversary Simulation Tools.” Security Research Report.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/haiyangxu\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EasonXu-HY99">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/haiyang-xu-8a2151212/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
<p>© 2025 Xu Haiyang. All Rights Reserved.</p>
</div>
    <div class="nav-footer-right">
<p>Built with ❤️ using Quarto &amp; Netlify</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>