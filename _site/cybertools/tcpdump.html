<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xu Haiyang">
<meta name="dcterms.date" content="2025-03-10">

<title>TCPDump: The Network Traffic Analysis Swiss Army Knife – Haiyang’s Tech Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Haiyang’s Tech Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Project Intern</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cybersecurity.html"> 
<span class="menu-text">Cybersecurity</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tools.html"> 
<span class="menu-text">Cyber Tools</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../coding.html"> 
<span class="menu-text">Coding</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cloud.html"> 
<span class="menu-text">AWS Cloud</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../github.html"> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../ai.html"> 
<span class="menu-text">AI</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EasonXu-HY99"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/haiyang-xu-8a2151212/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-tcpdump" id="toc-introduction-to-tcpdump" class="nav-link active" data-scroll-target="#introduction-to-tcpdump">Introduction to TCPDump</a></li>
  <li><a href="#core-features" id="toc-core-features" class="nav-link" data-scroll-target="#core-features">Core Features</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a>
  <ul class="collapse">
  <li><a href="#debianubuntu-based-systems" id="toc-debianubuntu-based-systems" class="nav-link" data-scroll-target="#debianubuntu-based-systems">Debian/Ubuntu-based Systems</a></li>
  <li><a href="#red-hatfedora-based-systems" id="toc-red-hatfedora-based-systems" class="nav-link" data-scroll-target="#red-hatfedora-based-systems">Red Hat/Fedora-based Systems</a></li>
  <li><a href="#macos-using-homebrew" id="toc-macos-using-homebrew" class="nav-link" data-scroll-target="#macos-using-homebrew">macOS (using Homebrew)</a></li>
  <li><a href="#freebsd" id="toc-freebsd" class="nav-link" data-scroll-target="#freebsd">FreeBSD</a></li>
  <li><a href="#building-from-source" id="toc-building-from-source" class="nav-link" data-scroll-target="#building-from-source">Building from Source</a></li>
  </ul></li>
  <li><a href="#basic-usage" id="toc-basic-usage" class="nav-link" data-scroll-target="#basic-usage">Basic Usage</a>
  <ul class="collapse">
  <li><a href="#common-basic-options" id="toc-common-basic-options" class="nav-link" data-scroll-target="#common-basic-options">Common Basic Options</a></li>
  </ul></li>
  <li><a href="#capture-filters" id="toc-capture-filters" class="nav-link" data-scroll-target="#capture-filters">Capture Filters</a>
  <ul class="collapse">
  <li><a href="#filter-by-protocol" id="toc-filter-by-protocol" class="nav-link" data-scroll-target="#filter-by-protocol">Filter by Protocol</a></li>
  <li><a href="#filter-by-host" id="toc-filter-by-host" class="nav-link" data-scroll-target="#filter-by-host">Filter by Host</a></li>
  <li><a href="#filter-by-network" id="toc-filter-by-network" class="nav-link" data-scroll-target="#filter-by-network">Filter by Network</a></li>
  <li><a href="#filter-by-port" id="toc-filter-by-port" class="nav-link" data-scroll-target="#filter-by-port">Filter by Port</a></li>
  </ul></li>
  <li><a href="#advanced-filtering-with-logical-operators" id="toc-advanced-filtering-with-logical-operators" class="nav-link" data-scroll-target="#advanced-filtering-with-logical-operators">Advanced Filtering with Logical Operators</a>
  <ul class="collapse">
  <li><a href="#and-operator-and" id="toc-and-operator-and" class="nav-link" data-scroll-target="#and-operator-and">AND Operator (and, &amp;&amp;)</a></li>
  <li><a href="#or-operator-or" id="toc-or-operator-or" class="nav-link" data-scroll-target="#or-operator-or">OR Operator (or, ||)</a></li>
  <li><a href="#not-operator-not" id="toc-not-operator-not" class="nav-link" data-scroll-target="#not-operator-not">NOT Operator (not, !)</a></li>
  <li><a href="#grouping-with-parentheses" id="toc-grouping-with-parentheses" class="nav-link" data-scroll-target="#grouping-with-parentheses">Grouping with Parentheses</a></li>
  </ul></li>
  <li><a href="#saving-and-reading-packet-captures" id="toc-saving-and-reading-packet-captures" class="nav-link" data-scroll-target="#saving-and-reading-packet-captures">Saving and Reading Packet Captures</a>
  <ul class="collapse">
  <li><a href="#writing-to-a-file" id="toc-writing-to-a-file" class="nav-link" data-scroll-target="#writing-to-a-file">Writing to a File</a></li>
  <li><a href="#reading-from-a-file" id="toc-reading-from-a-file" class="nav-link" data-scroll-target="#reading-from-a-file">Reading from a File</a></li>
  </ul></li>
  <li><a href="#analyzing-specific-protocols" id="toc-analyzing-specific-protocols" class="nav-link" data-scroll-target="#analyzing-specific-protocols">Analyzing Specific Protocols</a>
  <ul class="collapse">
  <li><a href="#http-traffic-analysis" id="toc-http-traffic-analysis" class="nav-link" data-scroll-target="#http-traffic-analysis">HTTP Traffic Analysis</a></li>
  <li><a href="#dns-query-monitoring" id="toc-dns-query-monitoring" class="nav-link" data-scroll-target="#dns-query-monitoring">DNS Query Monitoring</a></li>
  <li><a href="#ssh-connection-tracking" id="toc-ssh-connection-tracking" class="nav-link" data-scroll-target="#ssh-connection-tracking">SSH Connection Tracking</a></li>
  <li><a href="#httpstls-analysis" id="toc-httpstls-analysis" class="nav-link" data-scroll-target="#httpstls-analysis">HTTPS/TLS Analysis</a></li>
  <li><a href="#arp-traffic-monitoring" id="toc-arp-traffic-monitoring" class="nav-link" data-scroll-target="#arp-traffic-monitoring">ARP Traffic Monitoring</a></li>
  </ul></li>
  <li><a href="#output-formatting-and-interpretation" id="toc-output-formatting-and-interpretation" class="nav-link" data-scroll-target="#output-formatting-and-interpretation">Output Formatting and Interpretation</a>
  <ul class="collapse">
  <li><a href="#standard-output-format" id="toc-standard-output-format" class="nav-link" data-scroll-target="#standard-output-format">Standard Output Format</a></li>
  <li><a href="#common-tcp-flags" id="toc-common-tcp-flags" class="nav-link" data-scroll-target="#common-tcp-flags">Common TCP Flags</a></li>
  <li><a href="#verbosity-levels" id="toc-verbosity-levels" class="nav-link" data-scroll-target="#verbosity-levels">Verbosity Levels</a></li>
  </ul></li>
  <li><a href="#practical-use-cases" id="toc-practical-use-cases" class="nav-link" data-scroll-target="#practical-use-cases">Practical Use Cases</a>
  <ul class="collapse">
  <li><a href="#network-troubleshooting" id="toc-network-troubleshooting" class="nav-link" data-scroll-target="#network-troubleshooting">Network Troubleshooting</a></li>
  <li><a href="#security-monitoring" id="toc-security-monitoring" class="nav-link" data-scroll-target="#security-monitoring">Security Monitoring</a></li>
  <li><a href="#performance-analysis" id="toc-performance-analysis" class="nav-link" data-scroll-target="#performance-analysis">Performance Analysis</a></li>
  <li><a href="#bandwidth-monitoring" id="toc-bandwidth-monitoring" class="nav-link" data-scroll-target="#bandwidth-monitoring">Bandwidth Monitoring</a></li>
  </ul></li>
  <li><a href="#advanced-techniques" id="toc-advanced-techniques" class="nav-link" data-scroll-target="#advanced-techniques">Advanced Techniques</a>
  <ul class="collapse">
  <li><a href="#packet-size-filtering" id="toc-packet-size-filtering" class="nav-link" data-scroll-target="#packet-size-filtering">Packet Size Filtering</a></li>
  <li><a href="#fragment-filtering" id="toc-fragment-filtering" class="nav-link" data-scroll-target="#fragment-filtering">Fragment Filtering</a></li>
  <li><a href="#tcp-flag-combinations" id="toc-tcp-flag-combinations" class="nav-link" data-scroll-target="#tcp-flag-combinations">TCP Flag Combinations</a></li>
  <li><a href="#l7-protocol-analysis" id="toc-l7-protocol-analysis" class="nav-link" data-scroll-target="#l7-protocol-analysis">L7 Protocol Analysis</a></li>
  </ul></li>
  <li><a href="#integrating-with-other-tools" id="toc-integrating-with-other-tools" class="nav-link" data-scroll-target="#integrating-with-other-tools">Integrating with Other Tools</a>
  <ul class="collapse">
  <li><a href="#piping-to-grep" id="toc-piping-to-grep" class="nav-link" data-scroll-target="#piping-to-grep">Piping to grep</a></li>
  <li><a href="#using-with-tshark" id="toc-using-with-tshark" class="nav-link" data-scroll-target="#using-with-tshark">Using with tshark</a></li>
  <li><a href="#feeding-to-wireshark" id="toc-feeding-to-wireshark" class="nav-link" data-scroll-target="#feeding-to-wireshark">Feeding to Wireshark</a></li>
  </ul></li>
  <li><a href="#remote-monitoring" id="toc-remote-monitoring" class="nav-link" data-scroll-target="#remote-monitoring">Remote Monitoring</a>
  <ul class="collapse">
  <li><a href="#basic-remote-capture" id="toc-basic-remote-capture" class="nav-link" data-scroll-target="#basic-remote-capture">Basic Remote Capture</a></li>
  <li><a href="#live-remote-analysis" id="toc-live-remote-analysis" class="nav-link" data-scroll-target="#live-remote-analysis">Live Remote Analysis</a></li>
  <li><a href="#distributed-network-monitoring" id="toc-distributed-network-monitoring" class="nav-link" data-scroll-target="#distributed-network-monitoring">Distributed Network Monitoring</a></li>
  </ul></li>
  <li><a href="#performance-considerations" id="toc-performance-considerations" class="nav-link" data-scroll-target="#performance-considerations">Performance Considerations</a>
  <ul class="collapse">
  <li><a href="#optimizing-capture-performance" id="toc-optimizing-capture-performance" class="nav-link" data-scroll-target="#optimizing-capture-performance">Optimizing Capture Performance</a></li>
  <li><a href="#dealing-with-packet-loss" id="toc-dealing-with-packet-loss" class="nav-link" data-scroll-target="#dealing-with-packet-loss">Dealing with Packet Loss</a></li>
  <li><a href="#avoiding-system-impact" id="toc-avoiding-system-impact" class="nav-link" data-scroll-target="#avoiding-system-impact">Avoiding System Impact</a></li>
  </ul></li>
  <li><a href="#security-considerations" id="toc-security-considerations" class="nav-link" data-scroll-target="#security-considerations">Security Considerations</a>
  <ul class="collapse">
  <li><a href="#protecting-sensitive-data" id="toc-protecting-sensitive-data" class="nav-link" data-scroll-target="#protecting-sensitive-data">Protecting Sensitive Data</a></li>
  <li><a href="#access-control" id="toc-access-control" class="nav-link" data-scroll-target="#access-control">Access Control</a></li>
  </ul></li>
  <li><a href="#practical-examples-and-recipes" id="toc-practical-examples-and-recipes" class="nav-link" data-scroll-target="#practical-examples-and-recipes">Practical Examples and Recipes</a>
  <ul class="collapse">
  <li><a href="#monitoring-network-abuse" id="toc-monitoring-network-abuse" class="nav-link" data-scroll-target="#monitoring-network-abuse">Monitoring Network Abuse</a></li>
  <li><a href="#analyzing-dns-issues" id="toc-analyzing-dns-issues" class="nav-link" data-scroll-target="#analyzing-dns-issues">Analyzing DNS Issues</a></li>
  <li><a href="#web-server-monitoring" id="toc-web-server-monitoring" class="nav-link" data-scroll-target="#web-server-monitoring">Web Server Monitoring</a></li>
  <li><a href="#debugging-network-applications" id="toc-debugging-network-applications" class="nav-link" data-scroll-target="#debugging-network-applications">Debugging Network Applications</a></li>
  </ul></li>
  <li><a href="#advanced-filter-expressions" id="toc-advanced-filter-expressions" class="nav-link" data-scroll-target="#advanced-filter-expressions">Advanced Filter Expressions</a>
  <ul class="collapse">
  <li><a href="#layer-2-filtering" id="toc-layer-2-filtering" class="nav-link" data-scroll-target="#layer-2-filtering">Layer 2 Filtering</a></li>
  <li><a href="#layer-3-filtering" id="toc-layer-3-filtering" class="nav-link" data-scroll-target="#layer-3-filtering">Layer 3 Filtering</a></li>
  <li><a href="#layer-4-filtering" id="toc-layer-4-filtering" class="nav-link" data-scroll-target="#layer-4-filtering">Layer 4 Filtering</a></li>
  <li><a href="#layer-7-content-filtering" id="toc-layer-7-content-filtering" class="nav-link" data-scroll-target="#layer-7-content-filtering">Layer 7 Content Filtering</a></li>
  </ul></li>
  <li><a href="#scripting-with-tcpdump" id="toc-scripting-with-tcpdump" class="nav-link" data-scroll-target="#scripting-with-tcpdump">Scripting with TCPDump</a>
  <ul class="collapse">
  <li><a href="#basic-monitoring-script" id="toc-basic-monitoring-script" class="nav-link" data-scroll-target="#basic-monitoring-script">Basic Monitoring Script</a></li>
  <li><a href="#traffic-statistics-script" id="toc-traffic-statistics-script" class="nav-link" data-scroll-target="#traffic-statistics-script">Traffic Statistics Script</a></li>
  </ul></li>
  <li><a href="#troubleshooting-tcpdump-issues" id="toc-troubleshooting-tcpdump-issues" class="nav-link" data-scroll-target="#troubleshooting-tcpdump-issues">Troubleshooting TCPDump Issues</a>
  <ul class="collapse">
  <li><a href="#common-problems-and-solutions" id="toc-common-problems-and-solutions" class="nav-link" data-scroll-target="#common-problems-and-solutions">Common Problems and Solutions</a></li>
  </ul></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices">Best Practices</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TCPDump: The Network Traffic Analysis Swiss Army Knife</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Wireless Hacking</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xu Haiyang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction-to-tcpdump" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-tcpdump">Introduction to TCPDump</h2>
<p>TCPDump is a powerful command-line packet analyzer that allows you to intercept and display TCP/IP and other packets being transmitted or received over a network. As one of the oldest and most reliable network analysis tools available, TCPDump has become an essential utility for network administrators, security professionals, and anyone who needs to troubleshoot network issues or monitor network traffic.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media.geeksforgeeks.org/wp-content/uploads/20200521231351/capture-packets-tcpdump.png" class="img-fluid figure-img"></p>
<figcaption>TCPDump Terminal Output</figcaption>
</figure>
</div>
<p>Unlike graphical tools like Wireshark, TCPDump is designed for the command line, making it ideal for remote servers, headless systems, and automated scripts. Its lightweight nature and minimal dependencies allow it to run on virtually any Unix-like system, including Linux, BSD, macOS, and even embedded devices.</p>
</section>
<section id="core-features" class="level2">
<h2 class="anchored" data-anchor-id="core-features">Core Features</h2>
<p>TCPDump’s enduring popularity stems from several key features:</p>
<ul>
<li><strong>Versatile packet capturing</strong>: Capture packets on any network interface</li>
<li><strong>Powerful filtering expressions</strong>: Precisely target the traffic you want to analyze</li>
<li><strong>Minimal resource requirements</strong>: Run efficiently even on resource-constrained systems</li>
<li><strong>Scriptable output</strong>: Feed data into other tools for further processing</li>
<li><strong>Protocol decoder support</strong>: Understand and interpret numerous network protocols</li>
<li><strong>Remote monitoring capabilities</strong>: Analyze traffic on distant systems</li>
<li><strong>Extensive platform support</strong>: Available on virtually all Unix-like systems</li>
</ul>
</section>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">Installation</h2>
<p>TCPDump is typically pre-installed on many Linux distributions and Unix-like systems. If not, it can be easily installed:</p>
<section id="debianubuntu-based-systems" class="level3">
<h3 class="anchored" data-anchor-id="debianubuntu-based-systems">Debian/Ubuntu-based Systems</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install tcpdump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="red-hatfedora-based-systems" class="level3">
<h3 class="anchored" data-anchor-id="red-hatfedora-based-systems">Red Hat/Fedora-based Systems</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> dnf install tcpdump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="macos-using-homebrew" class="level3">
<h3 class="anchored" data-anchor-id="macos-using-homebrew">macOS (using Homebrew)</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install tcpdump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="freebsd" class="level3">
<h3 class="anchored" data-anchor-id="freebsd">FreeBSD</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkg</span> install tcpdump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="building-from-source" class="level3">
<h3 class="anchored" data-anchor-id="building-from-source">Building from Source</h3>
<p>For the latest version or custom builds:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download source code</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://www.tcpdump.org/release/tcpdump-4.99.4.tar.gz</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xvf</span> tcpdump-4.99.4.tar.gz</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> tcpdump-4.99.4</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure and build</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="ex">./configure</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> make install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="basic-usage" class="level2">
<h2 class="anchored" data-anchor-id="basic-usage">Basic Usage</h2>
<p>At its simplest, TCPDump can be invoked with just the interface name:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This command will: 1. Capture all packets on the eth0 interface 2. Display a summary of each packet to the terminal 3. Continue until interrupted (Ctrl+C)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.techplayon.com/wp-content/uploads/2020/11/man-tcpdump.png" class="img-fluid figure-img"></p>
<figcaption>Basic TCPDump Usage</figcaption>
</figure>
</div>
<section id="common-basic-options" class="level3">
<h3 class="anchored" data-anchor-id="common-basic-options">Common Basic Options</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Listen on all interfaces</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> any</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show more verbose output</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-v</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show even more details (very verbose)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-vv</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display ASCII and hex output</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-X</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Show packet headers and payload data</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-XX</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't resolve hostnames (faster)</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-n</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't resolve port names (faster)</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-nn</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't resolve both hostnames and port names</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-nnv</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="capture-filters" class="level2">
<h2 class="anchored" data-anchor-id="capture-filters">Capture Filters</h2>
<p>TCPDump’s real power comes from its Berkeley Packet Filter (BPF) syntax, which allows you to precisely specify which packets to capture:</p>
<section id="filter-by-protocol" class="level3">
<h3 class="anchored" data-anchor-id="filter-by-protocol">Filter by Protocol</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture only TCP packets</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 tcp</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture only UDP packets</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 udp</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture only ICMP packets</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 icmp</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture only IPv6 traffic</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 ip6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filter-by-host" class="level3">
<h3 class="anchored" data-anchor-id="filter-by-host">Filter by Host</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic to or from a specific IP</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 host 192.168.1.1</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic from a source IP</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 src host 192.168.1.1</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic to a destination IP</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 dst host 192.168.1.1</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic from a specific hostname</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 host example.com</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filter-by-network" class="level3">
<h3 class="anchored" data-anchor-id="filter-by-network">Filter by Network</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic to or from a subnet</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 net 192.168.1.0/24</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic from a source network</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 src net 10.0.0.0/8</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic to a destination network</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 dst net 172.16.0.0/16</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filter-by-port" class="level3">
<h3 class="anchored" data-anchor-id="filter-by-port">Filter by Port</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic on a specific port</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 port 80</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic on a source port</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 src port 1025</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic on a destination port</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 dst port 443</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic on a range of ports</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 portrange 21-23</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="advanced-filtering-with-logical-operators" class="level2">
<h2 class="anchored" data-anchor-id="advanced-filtering-with-logical-operators">Advanced Filtering with Logical Operators</h2>
<p>TCPDump filters can be combined using logical operators:</p>
<section id="and-operator-and" class="level3">
<h3 class="anchored" data-anchor-id="and-operator-and">AND Operator (and, &amp;&amp;)</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture HTTP traffic to a specific host</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'host 192.168.1.1 and port 80'</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture SSH traffic from a specific subnet</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'src net 10.0.0.0/8 and dst port 22'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="or-operator-or" class="level3">
<h3 class="anchored" data-anchor-id="or-operator-or">OR Operator (or, ||)</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture HTTPS or IMAPS traffic</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'port 443 or port 993'</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture traffic to either of two hosts</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'dst host 192.168.1.1 or dst host 192.168.1.2'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="not-operator-not" class="level3">
<h3 class="anchored" data-anchor-id="not-operator-not">NOT Operator (not, !)</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture all traffic except DNS</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'not port 53'</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture non-local traffic</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'not net 192.168.0.0/16'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="grouping-with-parentheses" class="level3">
<h3 class="anchored" data-anchor-id="grouping-with-parentheses">Grouping with Parentheses</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complex filter with grouping</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'(port 80 or port 443) and host 192.168.1.1'</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for all traffic except local HTTP and HTTPS</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'not ((dst net 192.168.0.0/16) and (port 80 or port 443))'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember to use single quotes around complex expressions to prevent the shell from interpreting special characters.</p>
</div>
</div>
</section>
</section>
<section id="saving-and-reading-packet-captures" class="level2">
<h2 class="anchored" data-anchor-id="saving-and-reading-packet-captures">Saving and Reading Packet Captures</h2>
<p>TCPDump can save captured packets to a file and read from saved captures:</p>
<section id="writing-to-a-file" class="level3">
<h3 class="anchored" data-anchor-id="writing-to-a-file">Writing to a File</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save captured packets to a file</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-w</span> capture.pcap</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture 100 packets then exit</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-w</span> capture.pcap <span class="at">-c</span> 100</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture for 30 seconds then exit</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-w</span> capture.pcap <span class="at">-G</span> 30</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="reading-from-a-file" class="level3">
<h3 class="anchored" data-anchor-id="reading-from-a-file">Reading from a File</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and display packets from a file</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">tcpdump</span> <span class="at">-r</span> capture.pcap</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply filters when reading</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="ex">tcpdump</span> <span class="at">-r</span> capture.pcap <span class="st">'host 192.168.1.1 and port 80'</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show specific details</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="ex">tcpdump</span> <span class="at">-r</span> capture.pcap <span class="at">-X</span> <span class="st">'tcp port 443'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.techtarget.com/rms/onlineimages/ref_1_tcpdump_capture-f_mobile.jpg" class="img-fluid figure-img"></p>
<figcaption>TCPDump File Operations</figcaption>
</figure>
</div>
</section>
</section>
<section id="analyzing-specific-protocols" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-specific-protocols">Analyzing Specific Protocols</h2>
<p>TCPDump can decode and analyze many protocols. Here are examples for common ones:</p>
<section id="http-traffic-analysis" class="level3">
<h3 class="anchored" data-anchor-id="http-traffic-analysis">HTTP Traffic Analysis</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture HTTP GET and POST requests</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-A</span> <span class="at">-s</span> 0 <span class="st">'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dns-query-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="dns-query-monitoring">DNS Query Monitoring</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture DNS queries and responses</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-n</span> <span class="st">'udp port 53'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ssh-connection-tracking" class="level3">
<h3 class="anchored" data-anchor-id="ssh-connection-tracking">SSH Connection Tracking</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor SSH connections</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp port 22'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="httpstls-analysis" class="level3">
<h3 class="anchored" data-anchor-id="httpstls-analysis">HTTPS/TLS Analysis</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture TLS handshakes (not the encrypted content)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp port 443 and (tcp[((tcp[12] &amp; 0xf0) &gt;&gt; 2)] = 0x16)'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="arp-traffic-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="arp-traffic-monitoring">ARP Traffic Monitoring</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture ARP requests and responses</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 arp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="output-formatting-and-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="output-formatting-and-interpretation">Output Formatting and Interpretation</h2>
<p>Understanding TCPDump’s output is key to effective analysis:</p>
<section id="standard-output-format" class="level3">
<h3 class="anchored" data-anchor-id="standard-output-format">Standard Output Format</h3>
<p>A typical TCPDump output line looks like:</p>
<pre><code>13:42:01.123456 IP 192.168.1.2.56789 &gt; 172.217.21.142.443: Flags [S], seq 1234567890, win 64240, options [mss 1460,...], length 0</code></pre>
<p>This breaks down as: - <strong>Timestamp</strong>: 13:42:01.123456 - <strong>Protocol</strong>: IP - <strong>Source</strong>: 192.168.1.2.56789 (IP address and port) - <strong>Destination</strong>: 172.217.21.142.443 (IP address and port) - <strong>Flags</strong>: [S] (SYN packet in this case) - <strong>Sequence number</strong>: 1234567890 - <strong>Window size</strong>: 64240 - <strong>Options</strong>: [mss 1460,…] - <strong>Payload length</strong>: 0 bytes</p>
</section>
<section id="common-tcp-flags" class="level3">
<h3 class="anchored" data-anchor-id="common-tcp-flags">Common TCP Flags</h3>
<ul>
<li><strong>[S]</strong>: SYN (Connection initiation)</li>
<li><strong>[.]</strong>: ACK (Acknowledgment)</li>
<li><strong>[P]</strong>: PSH (Push data)</li>
<li><strong>[F]</strong>: FIN (Connection termination)</li>
<li><strong>[R]</strong>: RST (Connection reset)</li>
<li><strong>[S.]</strong>: SYN-ACK (Connection establishment response)</li>
</ul>
</section>
<section id="verbosity-levels" class="level3">
<h3 class="anchored" data-anchor-id="verbosity-levels">Verbosity Levels</h3>
<p>Different verbosity levels (-v, -vv, -vvv) provide increasingly detailed information:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard output</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-c</span> 1 port 80</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 13:42:01.123456 IP 192.168.1.2.56789 &gt; 93.184.216.34.80: Flags [S], seq 1234567890, win 64240, length 0</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Verbose output</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-c</span> 1 <span class="at">-v</span> port 80</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 13:42:01.123456 IP (tos 0x0, ttl 64, id 12345, offset 0, flags [DF], proto TCP (6), length 60)</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   192.168.1.2.56789 &gt; 93.184.216.34.80: Flags [S], cksum 0x1234 (correct), seq 1234567890, win 64240, options [mss 1460,...], length 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="practical-use-cases" class="level2">
<h2 class="anchored" data-anchor-id="practical-use-cases">Practical Use Cases</h2>
<p>TCPDump proves invaluable in numerous networking scenarios:</p>
<section id="network-troubleshooting" class="level3">
<h3 class="anchored" data-anchor-id="network-troubleshooting">Network Troubleshooting</h3>
<p>Identify connectivity issues:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if traffic is reaching a destination</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-nn</span> <span class="st">'host problematic-server.example.com'</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor connection attempts</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] &amp; (tcp-syn|tcp-fin|tcp-rst) != 0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="security-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="security-monitoring">Security Monitoring</h3>
<p>Detect suspicious network activity:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor for port scans</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] == tcp-syn'</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Look for unusual ICMP traffic (potential DOS)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'icmp and icmp[icmptype] == icmp-echo'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="performance-analysis" class="level3">
<h3 class="anchored" data-anchor-id="performance-analysis">Performance Analysis</h3>
<p>Analyze network performance issues:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor retransmissions</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] &amp; (tcp-syn|tcp-fin|tcp-rst) == 0 and (tcp[4:4] = 1 or tcp[4:4] = 0)'</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for packet fragmentation</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'(ip[6:2] &amp; 0x1fff) != 0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="bandwidth-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="bandwidth-monitoring">Bandwidth Monitoring</h3>
<p>Identify bandwidth-intensive applications:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find large packets</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'greater 1000'</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor high-volume connections</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-nn</span> <span class="at">-v</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-i</span> <span class="st">"length"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="advanced-techniques" class="level2">
<h2 class="anchored" data-anchor-id="advanced-techniques">Advanced Techniques</h2>
<section id="packet-size-filtering" class="level3">
<h3 class="anchored" data-anchor-id="packet-size-filtering">Packet Size Filtering</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture small packets (under 64 bytes)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'len &lt; 64'</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture jumbo frames</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'len &gt; 1500'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="fragment-filtering" class="level3">
<h3 class="anchored" data-anchor-id="fragment-filtering">Fragment Filtering</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all IP fragments</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'ip[6:2] &amp; 0x1fff != 0'</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the first fragment of each packet</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'ip[6:2] &amp; 0x1fff != 0 and ip[6] &amp; 0x20 = 0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tcp-flag-combinations" class="level3">
<h3 class="anchored" data-anchor-id="tcp-flag-combinations">TCP Flag Combinations</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find potential SYN flood attacks</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] == tcp-syn and not tcp[tcpflags] &amp; (tcp-ack) != 0'</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all RST packets</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] &amp; (tcp-rst) != 0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="l7-protocol-analysis" class="level3">
<h3 class="anchored" data-anchor-id="l7-protocol-analysis">L7 Protocol Analysis</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic HTTP header capture</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-A</span> <span class="at">-s</span> 0 <span class="st">'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find HTTP GET requests</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-s</span> 0 <span class="at">-A</span> <span class="st">'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="integrating-with-other-tools" class="level2">
<h2 class="anchored" data-anchor-id="integrating-with-other-tools">Integrating with Other Tools</h2>
<p>TCPDump works well with other tools in the network analysis ecosystem:</p>
<section id="piping-to-grep" class="level3">
<h3 class="anchored" data-anchor-id="piping-to-grep">Piping to grep</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for specific content in packets</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-A</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">'User-Agent'</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count packets by type</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-nn</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-c</span> <span class="st">'tcp port 80'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="using-with-tshark" class="level3">
<h3 class="anchored" data-anchor-id="using-with-tshark">Using with tshark</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture with tcpdump, analyze with tshark</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-w</span> <span class="at">-</span> <span class="kw">|</span> <span class="ex">tshark</span> <span class="at">-r</span> <span class="at">-</span> <span class="at">-Y</span> <span class="st">'http'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="feeding-to-wireshark" class="level3">
<h3 class="anchored" data-anchor-id="feeding-to-wireshark">Feeding to Wireshark</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remote capture to local Wireshark</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> user@remote-server <span class="st">"sudo tcpdump -i eth0 -w - 'not port 22'"</span> <span class="kw">|</span> <span class="ex">wireshark</span> <span class="at">-k</span> <span class="at">-i</span> <span class="at">-</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSG6c14ujK2SG6bEqqCuMzW6GhhmxKbYNwMRg&amp;s.png" class="img-fluid figure-img"></p>
<figcaption>TCPDump with Wireshark</figcaption>
</figure>
</div>
</section>
</section>
<section id="remote-monitoring" class="level2">
<h2 class="anchored" data-anchor-id="remote-monitoring">Remote Monitoring</h2>
<p>TCPDump excels at remote network monitoring:</p>
<section id="basic-remote-capture" class="level3">
<h3 class="anchored" data-anchor-id="basic-remote-capture">Basic Remote Capture</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture on remote system</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> user@remote-server <span class="st">"sudo tcpdump -i eth0 -nn -w - 'port 80'"</span> <span class="op">&gt;</span> remote-capture.pcap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="live-remote-analysis" class="level3">
<h3 class="anchored" data-anchor-id="live-remote-analysis">Live Remote Analysis</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Live analysis of remote traffic</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> user@remote-server <span class="st">"sudo tcpdump -i eth0 -nn -l 'not port 22'"</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">"suspicious-pattern"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="distributed-network-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="distributed-network-monitoring">Distributed Network Monitoring</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create capture script</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">'#!/bin/bash</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="st">INTERFACE="eth0"</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">FILTER="not port 22"</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">OUTPUT_DIR="/var/log/tcpdump"</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">DATE=$(date +%Y%m%d-%H%M%S)</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="st">FILE="$OUTPUT_DIR/capture-$DATE.pcap"</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="st">mkdir -p $OUTPUT_DIR</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="st">tcpdump -i $INTERFACE -G 3600 -w $FILE -W 24 $FILTER'</span> <span class="op">&gt;</span> capture-script.sh</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Deploy to multiple servers</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> server <span class="kw">in</span> server1 server2 server3<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scp</span> capture-script.sh user@<span class="va">$server</span>:/tmp/</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ssh</span> user@<span class="va">$server</span> <span class="st">"sudo bash /tmp/capture-script.sh &amp;"</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="performance-considerations" class="level2">
<h2 class="anchored" data-anchor-id="performance-considerations">Performance Considerations</h2>
<p>While TCPDump is efficient, high-volume packet capturing requires attention to performance:</p>
<section id="optimizing-capture-performance" class="level3">
<h3 class="anchored" data-anchor-id="optimizing-capture-performance">Optimizing Capture Performance</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use strict filters to reduce load</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'host 192.168.1.1 and port 80'</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit captured packet size for header-only analysis</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-s</span> 96 <span class="st">'tcp'</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Disable name resolution for speed</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-nn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dealing-with-packet-loss" class="level3">
<h3 class="anchored" data-anchor-id="dealing-with-packet-loss">Dealing with Packet Loss</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Increase buffer size for high-traffic networks</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-B</span> 524288 <span class="at">-w</span> capture.pcap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="avoiding-system-impact" class="level3">
<h3 class="anchored" data-anchor-id="avoiding-system-impact">Avoiding System Impact</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use lowest priority to minimize system impact</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nice <span class="at">-n</span> 19 tcpdump <span class="at">-i</span> eth0 <span class="at">-w</span> capture.pcap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="security-considerations" class="level2">
<h2 class="anchored" data-anchor-id="security-considerations">Security Considerations</h2>
<section id="protecting-sensitive-data" class="level3">
<h3 class="anchored" data-anchor-id="protecting-sensitive-data">Protecting Sensitive Data</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit packet capture size to avoid capturing payloads</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-s</span> 96 <span class="at">-w</span> capture.pcap</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Anonymize IP addresses in output</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="kw">|</span> <span class="fu">awk</span> <span class="st">'{gsub(/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/, "x.x.x.x"); print}'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="access-control" class="level3">
<h3 class="anchored" data-anchor-id="access-control">Access Control</h3>
<p>TCPDump typically requires root privileges, which presents security considerations:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow specific users to capture packets</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> setcap cap_net_raw,cap_net_admin=eip /usr/bin/tcpdump</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chmod o-x /usr/bin/tcpdump</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> setfacl <span class="at">-m</span> u:username:rx /usr/bin/tcpdump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using TCPDump to capture network traffic without proper authorization may violate privacy laws and organizational policies. Always ensure you have appropriate permission before monitoring network traffic.</p>
</div>
</div>
</section>
</section>
<section id="practical-examples-and-recipes" class="level2">
<h2 class="anchored" data-anchor-id="practical-examples-and-recipes">Practical Examples and Recipes</h2>
<section id="monitoring-network-abuse" class="level3">
<h3 class="anchored" data-anchor-id="monitoring-network-abuse">Monitoring Network Abuse</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect port scanning</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-nn</span> <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] == tcp-syn and not src net 192.168.0.0/16'</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find SSH brute force attempts</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-nn</span> <span class="at">-i</span> eth0 <span class="st">'tcp dst port 22 and tcp[tcpflags] == tcp-syn'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="analyzing-dns-issues" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-dns-issues">Analyzing DNS Issues</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor DNS queries and responses</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-n</span> <span class="st">'udp port 53'</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture only failed DNS lookups (truncated responses)</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-n</span> <span class="st">'udp port 53 and tcp[tcpflags] &amp; (tcp-syn|tcp-fin|tcp-rst) != 0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="web-server-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="web-server-monitoring">Web Server Monitoring</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor all HTTP traffic to your web server</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-nn</span> <span class="at">-s0</span> <span class="at">-v</span> <span class="st">'dst host 192.168.1.100 and tcp port 80'</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect slow HTTP attacks</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-A</span> <span class="st">'dst host 192.168.1.100 and tcp port 80 and tcp[32:4] = 0x47455420'</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-i</span> <span class="st">"host:"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="debugging-network-applications" class="level3">
<h3 class="anchored" data-anchor-id="debugging-network-applications">Debugging Network Applications</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace all connections to a specific application</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-nn</span> <span class="st">'port 8080'</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor connection establishment and termination</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[tcpflags] &amp; (tcp-syn|tcp-fin|tcp-rst) != 0 and port 3306'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="advanced-filter-expressions" class="level2">
<h2 class="anchored" data-anchor-id="advanced-filter-expressions">Advanced Filter Expressions</h2>
<p>TCPDump supports sophisticated expressions that can target very specific packet types:</p>
<section id="layer-2-filtering" class="level3">
<h3 class="anchored" data-anchor-id="layer-2-filtering">Layer 2 Filtering</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by MAC address</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'ether host 00:11:22:33:44:55'</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by Ethernet type</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'ether proto 0x0800'</span>  <span class="co"># IPv4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="layer-3-filtering" class="level3">
<h3 class="anchored" data-anchor-id="layer-3-filtering">Layer 3 Filtering</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by IP protocol</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'ip proto 6'</span>  <span class="co"># TCP</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by IP options</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'ip[0] &amp; 0x0f &gt; 5'</span>  <span class="co"># Packets with IP options</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="layer-4-filtering" class="level3">
<h3 class="anchored" data-anchor-id="layer-4-filtering">Layer 4 Filtering</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter specific TCP flags</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[13] &amp; 2 != 0'</span>  <span class="co"># SYN flag set</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter TCP window size</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'tcp[14:2] &lt; 1000'</span>  <span class="co"># Small window size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="layer-7-content-filtering" class="level3">
<h3 class="anchored" data-anchor-id="layer-7-content-filtering">Layer 7 Content Filtering</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find HTTP POST requests</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-s</span> 0 <span class="at">-A</span> <span class="st">'tcp port 80 and tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354'</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find packets containing specific content</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="at">-A</span> <span class="st">'tcp and tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):(((tcp[12:1] &amp; 0xf0) &gt;&gt; 2) + 100)] matches "password"'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="scripting-with-tcpdump" class="level2">
<h2 class="anchored" data-anchor-id="scripting-with-tcpdump">Scripting with TCPDump</h2>
<p>TCPDump can be integrated into scripts for automated monitoring:</p>
<section id="basic-monitoring-script" class="level3">
<h3 class="anchored" data-anchor-id="basic-monitoring-script">Basic Monitoring Script</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple script to monitor for unusual SSH traffic</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="va">INTERFACE</span><span class="op">=</span><span class="st">"eth0"</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="va">LOG_FILE</span><span class="op">=</span><span class="st">"/var/log/ssh_monitoring.log"</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Starting SSH monitoring at </span><span class="va">$(</span><span class="fu">date</span><span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> <span class="va">$LOG_FILE</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> <span class="va">$INTERFACE</span> <span class="at">-nn</span> <span class="st">'tcp dst port 22'</span> <span class="kw">|</span> <span class="cf">while</span> <span class="bu">read</span> <span class="va">line</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">"</span><span class="va">$(</span><span class="fu">date</span><span class="va">)</span><span class="st">: </span><span class="va">$line</span><span class="st">"</span> <span class="op">&gt;&gt;</span> <span class="va">$LOG_FILE</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for multiple connection attempts from same source</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="va">SOURCE_IP</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$line</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-oE</span> <span class="st">'([0-9]{1,3}\.){3}[0-9]{1,3}\.22'</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">'s/\.22$//'</span><span class="va">)</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="va">COUNT</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">"</span><span class="va">$SOURCE_IP</span><span class="st">"</span> <span class="va">$LOG_FILE</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">[</span> <span class="va">$COUNT</span> <span class="ot">-gt</span> 10 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"ALERT: Possible brute force from </span><span class="va">$SOURCE_IP</span><span class="st"> (</span><span class="va">$COUNT</span><span class="st"> attempts)"</span> <span class="op">&gt;&gt;</span> <span class="va">$LOG_FILE</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add remediation actions here (e.g., firewall block)</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">fi</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="traffic-statistics-script" class="level3">
<h3 class="anchored" data-anchor-id="traffic-statistics-script">Traffic Statistics Script</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate traffic statistics with tcpdump</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="va">INTERFACE</span><span class="op">=</span><span class="st">"eth0"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="va">DURATION</span><span class="op">=</span>60  <span class="co"># seconds</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="va">OUTPUT_FILE</span><span class="op">=</span><span class="st">"traffic_stats.txt"</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Traffic Statistics Report - </span><span class="va">$(</span><span class="fu">date</span><span class="va">)</span><span class="st">"</span> <span class="op">&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Duration: </span><span class="va">$DURATION</span><span class="st"> seconds"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"--------------------------"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Count packets by protocol</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Protocol Distribution:"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> timeout <span class="va">$DURATION</span> tcpdump <span class="at">-i</span> <span class="va">$INTERFACE</span> <span class="at">-nn</span> <span class="op">&gt;</span> temp.txt</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"TCP: </span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-c</span> <span class="st">"TCP"</span> temp.txt<span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"UDP: </span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-c</span> <span class="st">"UDP"</span> temp.txt<span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"ICMP: </span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-c</span> <span class="st">"ICMP"</span> temp.txt<span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Other: </span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-v</span> <span class="st">"TCP\|UDP\|ICMP"</span> temp.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Top talkers</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"--------------------------"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Top 5 Source IPs:"</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> temp.txt <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-oE</span> <span class="st">'([0-9]{1,3}\.){3}[0-9]{1,3}\.[0-9]+'</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d.</span> <span class="at">-f1-4</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="at">-c</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-nr</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-5</span> <span class="op">&gt;&gt;</span> <span class="va">$OUTPUT_FILE</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> temp.txt</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Report generated: </span><span class="va">$OUTPUT_FILE</span><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="troubleshooting-tcpdump-issues" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting-tcpdump-issues">Troubleshooting TCPDump Issues</h2>
<section id="common-problems-and-solutions" class="level3">
<h3 class="anchored" data-anchor-id="common-problems-and-solutions">Common Problems and Solutions</h3>
<section id="permission-denied" class="level4">
<h4 class="anchored" data-anchor-id="permission-denied">Permission Denied</h4>
<pre><code>tcpdump: eth0: You don't have permission to capture on that device</code></pre>
<p>Solution:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run as root or with sudo</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or set capabilities for non-root use</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> setcap cap_net_raw,cap_net_admin=eip /usr/bin/tcpdump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="interface-not-found" class="level4">
<h4 class="anchored" data-anchor-id="interface-not-found">Interface Not Found</h4>
<pre><code>tcpdump: eth0: No such device exists</code></pre>
<p>Solution:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List available interfaces</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ip</span> link show</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the correct interface name</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> correct_interface_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="syntax-errors-in-filters" class="level4">
<h4 class="anchored" data-anchor-id="syntax-errors-in-filters">Syntax Errors in Filters</h4>
<pre><code>tcpdump: syntax error in filter expression</code></pre>
<p>Solution:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure complex expressions are quoted properly</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 <span class="st">'host 192.168.1.1 and port 80'</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for typos in protocol names or expressions</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tcpdump <span class="at">-i</span> eth0 tcp  <span class="co"># not 'tpc'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="best-practices" class="level2">
<h2 class="anchored" data-anchor-id="best-practices">Best Practices</h2>
<p>To get the most out of TCPDump, follow these best practices:</p>
<ol type="1">
<li><strong>Use specific filters</strong>: Target only the traffic you need to analyze</li>
<li><strong>Limit capture size</strong> (-s option) when full packet contents aren’t needed</li>
<li><strong>Save to files</strong> (-w option) for large captures or detailed analysis</li>
<li><strong>Disable name resolution</strong> (-n/-nn) for better performance</li>
<li><strong>Increase buffer size</strong> (-B option) on busy networks</li>
<li><strong>Add timestamps</strong> (-tttt option) for time correlation</li>
<li><strong>Use verbose mode</strong> (-v/-vv) when troubleshooting specific issues</li>
<li><strong>Consider privacy implications</strong> and avoid capturing sensitive data</li>
<li><strong>Rotate capture files</strong> (-G/-W options) for long-term monitoring</li>
<li><strong>Feed output to specialized tools</strong> like Wireshark for detailed analysis</li>
</ol>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>TCPDump remains a cornerstone of network analysis tools due to its versatility, efficiency, and powerful filtering capabilities. From basic troubleshooting to advanced security monitoring, it provides invaluable insights into network traffic with minimal overhead.</p>
<p>By mastering TCPDump’s filtering syntax and combining it with other tools, network professionals can diagnose problems, detect security issues, and understand network behavior in ways that would otherwise be impossible. While graphical tools like Wireshark offer more visual analysis, TCPDump’s command-line nature makes it uniquely suitable for server environments, scripting, and remote troubleshooting.</p>
<p>Whether you’re a network administrator, security professional, or developer, adding TCPDump to your toolbox provides a powerful means to see beyond the surface of your network and understand what’s really happening at the packet level.</p>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li><a href="https://www.tcpdump.org/">Official TCPDump Website</a></li>
<li><a href="https://github.com/pcapng/pcapng">PCAPng File Format</a></li>
<li><a href="https://biot.com/capstats/bpf.html">Berkeley Packet Filter (BPF) Documentation</a></li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>Hunt, C. (2022). <em>TCP/IP Network Administration</em>. O’Reilly Media.</li>
<li>Bejtlich, R. (2023). “Network Security Monitoring Fundamentals.” <em>Journal of Cybersecurity Analysis</em>, 14(2), 87-94.</li>
<li>Stevens, W. R., Fenner, B., &amp; Rudoff, A. M. (2024). <em>UNIX Network Programming</em>. Addison-Wesley Professional.</li>
<li>Kozierok, C. M. (2024). “Packet Analysis Techniques for Network Troubleshooting.” <em>IEEE Communications Magazine</em>, 62(1), 45-51.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/haiyangxu\.netlify\.app\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EasonXu-HY99">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/haiyang-xu-8a2151212/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
<p>© 2025 Xu Haiyang. All Rights Reserved.</p>
</div>
    <div class="nav-footer-right">
<p>Built with ❤️ using Quarto &amp; Netlify</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>